<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IMPERIUM - Carte du Monde</title>
    <meta name="description" content="Explorez le monde méditerranéen, découvrez de nouvelles îles et étendez votre empire romain.">
    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><rect width='32' height='32' fill='%23b45309'/><text x='16' y='20' text-anchor='middle' fill='white' font-family='serif' font-size='20' font-weight='bold'>I</text></svg>" type="image/svg+xml">

    <!-- Styles et scripts communs -->
    <link rel="stylesheet" href="../common-styles.css">
    <script src="../common-navigation.js"></script>

    <style>
        /* Styles spécifiques à la carte du monde */
        .world-layout {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 2rem;
            height: calc(100% - 100px);
        }

        .world-map-container {
            position: relative;
            background: rgba(15, 23, 42, 0.8);
            border-radius: 1rem;
            border: 2px solid var(--gold-primary);
            overflow: hidden;
        }

        .world-map {
            width: 100%;
            height: 100%;
            min-height: 600px;
            background: 
                radial-gradient(circle at 20% 30%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(16, 185, 129, 0.1) 0%, transparent 50%),
                linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
            position: relative;
        }

        .map-controls {
            position: absolute;
            top: 1rem;
            right: 1rem;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            z-index: 10;
        }

        .map-btn {
            width: 40px;
            height: 40px;
            background: rgba(30, 41, 59, 0.9);
            border: 1px solid var(--border-gold);
            border-radius: 0.5rem;
            color: var(--gold-light);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
        }

        .map-btn:hover {
            background: var(--gold-primary);
            color: white;
            transform: scale(1.1);
        }

        .map-legend {
            position: absolute;
            bottom: 1rem;
            left: 1rem;
            background: rgba(30, 41, 59, 0.9);
            border: 1px solid var(--border-gold);
            border-radius: 0.5rem;
            padding: 1rem;
            z-index: 10;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
            color: var(--text-light);
            font-size: 0.9rem;
        }

        .legend-item:last-child {
            margin-bottom: 0;
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 2px;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .world-panel {
            background: rgba(15, 23, 42, 0.8);
            border-radius: 1rem;
            border: 1px solid var(--border-gold);
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            overflow-y: auto;
        }

        .panel-section {
            background: rgba(30, 41, 59, 0.6);
            border-radius: 0.5rem;
            padding: 1rem;
            border: 1px solid var(--border-gold);
        }

        .section-title {
            color: var(--gold-primary);
            font-size: 1.1rem;
            font-weight: bold;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .island-card {
            background: rgba(30, 41, 59, 0.6);
            border-radius: 0.8rem;
            border: 1px solid var(--border-gold);
            padding: 1.5rem;
        }

        .island-name {
            color: var(--gold-primary);
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .island-type, .island-players, .island-status {
            color: var(--text-light);
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }

        .island-resources {
            margin: 1rem 0;
        }

        .resource-bonus {
            background: rgba(217, 119, 6, 0.2);
            color: var(--gold-light);
            padding: 0.3rem 0.8rem;
            border-radius: 1rem;
            font-size: 0.8rem;
            border: 1px solid var(--gold-primary);
            margin-bottom: 0.3rem;
            display: inline-block;
            margin-right: 0.5rem;
        }

        .island-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .action-btn {
            flex: 1;
            padding: 0.6rem;
            background: linear-gradient(135deg, var(--gold-primary), var(--gold-secondary));
            color: white;
            border: none;
            border-radius: 0.5rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Times New Roman', serif;
            font-size: 0.9rem;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px var(--shadow-gold);
        }

        .fleet-list {
            max-height: 200px;
            overflow-y: auto;
        }

        .fleet-item {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            padding: 1rem;
            margin-bottom: 1rem;
            background: rgba(30, 41, 59, 0.6);
            border-radius: 0.8rem;
            border: 1px solid var(--border-gold);
        }

        .fleet-icon {
            font-size: 2rem;
            flex-shrink: 0;
        }

        .fleet-info {
            flex: 1;
        }

        .fleet-name {
            color: var(--gold-light);
            font-weight: bold;
            margin-bottom: 0.3rem;
        }

        .fleet-composition, .fleet-status, .fleet-eta {
            color: var(--text-muted);
            font-size: 0.9rem;
            margin-bottom: 0.2rem;
        }

        .world-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .stat-item {
            text-align: center;
            background: rgba(30, 41, 59, 0.6);
            padding: 1rem;
            border-radius: 0.5rem;
            border: 1px solid var(--border-gold);
        }

        .stat-label {
            color: var(--text-muted);
            font-size: 0.8rem;
            margin-bottom: 0.3rem;
        }

        .stat-value {
            color: var(--gold-light);
            font-size: 1.3rem;
            font-weight: bold;
        }

        .quick-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.5rem;
        }

        .quick-btn {
            padding: 0.8rem;
            background: rgba(30, 41, 59, 0.8);
            color: var(--text-light);
            border: 1px solid var(--border-gold);
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Times New Roman', serif;
            font-size: 0.9rem;
        }

        .quick-btn:hover {
            border-color: var(--gold-light);
            transform: translateY(-2px);
            background: rgba(217, 119, 6, 0.1);
        }

        /* Îles sur la carte */
        .island-marker {
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid var(--gold-primary);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .island-marker:hover {
            transform: scale(1.5);
            z-index: 5;
        }

        .island-marker.my-territory {
            background: var(--gold-primary);
            color: white;
        }

        .island-marker.enemy {
            background: #dc2626;
            color: white;
        }

        .island-marker.ally {
            background: #16a34a;
            color: white;
        }

        .island-marker.neutral {
            background: #6b7280;
            color: white;
        }

        .trade-route {
            position: absolute;
            height: 2px;
            background: linear-gradient(90deg, var(--gold-primary), transparent, var(--gold-primary));
            opacity: 0.7;
            pointer-events: none;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .world-layout {
                grid-template-columns: 1fr;
                grid-template-rows: 1fr auto;
            }
            
            .world-map-container {
                min-height: 400px;
            }
        }
    </style>
</head>
<body>
    <!-- Particules d'arrière-plan -->
    <div class="particles"></div>

    <!-- INTERFACE PRINCIPALE DU JEU -->
    <div class="imperium-ui">
        <!-- HEADER -->
        <header class="imperium-header">
            <div class="header-content">
                <h1 class="imperium-logo">IMPERIUM</h1>
                <div id="resources-display" class="resources-display">
                    <!-- Les ressources seront injectées ici par JS -->
                </div>
                <div class="player-info">
                    <div class="player-avatar" id="player-avatar">M</div>
                    <div>
                        <div class="player-name" id="player-name"></div>
                        <div class="player-level" id="player-title-level"></div>
                    </div>
                </div>
            </div>
        </header>

        <!-- CORPS PRINCIPAL -->
        <div class="imperium-body">
            <!-- BARRE LATERALE (Desktop) -->
            <aside class="imperium-sidebar">
                <!-- Navigation générée dynamiquement par common-navigation.js -->
            </aside>

            <!-- CONTENU PRINCIPAL -->
            <main class="main-content">
                <div class="view-container">
                    <h2 class="view-title">Carte du Monde Méditerranéen</h2>
                    <div class="world-layout">
                        <!-- Carte principale -->
                        <div class="world-map-container">
                            <div id="world-map" class="world-map"></div>
                            <div class="map-controls">
                                <button class="map-btn" id="zoom-in" title="Zoom avant">🔍+</button>
                                <button class="map-btn" id="zoom-out" title="Zoom arrière">🔍-</button>
                                <button class="map-btn" id="center-map" title="Centrer sur mes territoires">🎯</button>
                                <button class="map-btn" id="toggle-routes" title="Afficher/Masquer les routes">🛣️</button>
                            </div>
                            <div class="map-legend">
                                <div class="legend-item">
                                    <span class="legend-color" style="background: #d97706;"></span>
                                    <span>Mes Territoires</span>
                                </div>
                                <div class="legend-item">
                                    <span class="legend-color" style="background: #dc2626;"></span>
                                    <span>Ennemis</span>
                                </div>
                                <div class="legend-item">
                                    <span class="legend-color" style="background: #16a34a;"></span>
                                    <span>Alliés</span>
                                </div>
                                <div class="legend-item">
                                    <span class="legend-color" style="background: #6b7280;"></span>
                                    <span>Neutres</span>
                                </div>
                            </div>
                        </div>

                        <!-- Panneau d'informations -->
                        <div class="world-panel">
                            <div class="panel-section">
                                <h3 class="section-title">🏝️ Île Sélectionnée</h3>
                                <div id="island-info">
                                    <div class="island-card">
                                        <div class="island-name">Sicilia Prima</div>
                                        <div class="island-type">🍇 Spécialité: Vin (+25%)</div>
                                        <div class="island-players">👥 Joueurs: 34/50</div>
                                        <div class="island-status">⚔️ En guerre</div>
                                        <div class="island-resources">
                                            <div class="resource-bonus">🍇 +25% Production Vin</div>
                                            <div class="resource-bonus">🏛️ Marbre rare disponible</div>
                                        </div>
                                        <div class="island-actions">
                                            <button class="action-btn">🚢 Coloniser</button>
                                            <button class="action-btn">👁️ Espionner</button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="panel-section">
                                <h3 class="section-title">🚢 Mes Flottes</h3>
                                <div class="fleet-list">
                                    <div class="fleet-item">
                                        <div class="fleet-icon">⚓</div>
                                        <div class="fleet-info">
                                            <div class="fleet-name">Flotte Marcus</div>
                                            <div class="fleet-composition">5 Trirèmes, 2 Transports</div>
                                            <div class="fleet-status">🗺️ En route vers Corsica</div>
                                            <div class="fleet-eta">⏱️ Arrivée dans 2h 15min</div>
                                        </div>
                                    </div>
                                    <div class="fleet-item">
                                        <div class="fleet-icon">🏴‍☠️</div>
                                        <div class="fleet-info">
                                            <div class="fleet-name">Flotte Raid</div>
                                            <div class="fleet-composition">8 Quinquérèmes</div>
                                            <div class="fleet-status">⚔️ Attaque Carthago</div>
                                            <div class="fleet-eta">⏱️ Combat dans 45min</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="panel-section">
                                <h3 class="section-title">📊 Statistiques Mondiales</h3>
                                <div class="world-stats">
                                    <div class="stat-item">
                                        <div class="stat-label">Mon Rang</div>
                                        <div class="stat-value">#47</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-label">Îles Contrôlées</div>
                                        <div class="stat-value">3</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-label">Influence</div>
                                        <div class="stat-value">15,420</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-label">Routes Commerciales</div>
                                        <div class="stat-value">7</div>
                                    </div>
                                </div>
                            </div>

                            <div class="panel-section">
                                <h3 class="section-title">🎯 Actions Rapides</h3>
                                <div class="quick-actions">
                                    <button class="quick-btn">🚢 Nouvelle Expédition</button>
                                    <button class="quick-btn">🗺️ Explorer</button>
                                    <button class="quick-btn">⚖️ Commerce</button>
                                    <button class="quick-btn">🤝 Diplomatie</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script>
        // Configuration des îles selon le README
        const MEDITERRANEAN_ISLANDS = [
            // Mes territoires (Empire Romain)
            { x: 25, y: 45, type: 'my-territory', name: 'Roma', specialty: 'capital', bonus: 'Commerce +30%' },
            { x: 35, y: 55, type: 'my-territory', name: 'Sicilia', specialty: 'wine', bonus: 'Vin +25%' },
            { x: 20, y: 35, type: 'my-territory', name: 'Corsica', specialty: 'stone', bonus: 'Pierre +25%' },
            
            // Alliés
            { x: 45, y: 40, type: 'ally', name: 'Creta', specialty: 'iron', bonus: 'Fer +25%' },
            { x: 55, y: 35, type: 'ally', name: 'Cyprus', specialty: 'wine', bonus: 'Vin +25%' },
            
            // Ennemis
            { x: 30, y: 65, type: 'enemy', name: 'Carthago', specialty: 'iron', bonus: 'Fer +30%' },
            { x: 15, y: 25, type: 'enemy', name: 'Gallia', specialty: 'stone', bonus: 'Pierre +25%' },
            { x: 70, y: 50, type: 'enemy', name: 'Aegyptus', specialty: 'wine', bonus: 'Vin +25%' },
            
            // Neutres
            { x: 40, y: 25, type: 'neutral', name: 'Sardinia', specialty: 'iron', bonus: 'Fer +25%' },
            { x: 60, y: 60, type: 'neutral', name: 'Rhodos', specialty: 'stone', bonus: 'Pierre +25%' },
            { x: 50, y: 20, type: 'neutral', name: 'Hispania', specialty: 'wine', bonus: 'Vin +25%' },
            { x: 65, y: 30, type: 'neutral', name: 'Anatolia', specialty: 'iron', bonus: 'Fer +25%' },
            { x: 10, y: 50, type: 'neutral', name: 'Britannia', specialty: 'stone', bonus: 'Pierre +25%' },
            { x: 75, y: 40, type: 'neutral', name: 'Pontus', specialty: 'wine', bonus: 'Vin +25%' },
            { x: 25, y: 70, type: 'neutral', name: 'Numidia', specialty: 'iron', bonus: 'Fer +25%' }
        ];

        // Ajouter les îles sur la carte
        document.addEventListener('DOMContentLoaded', function() {
            const worldMap = document.getElementById('world-map');
            if (worldMap) {
                // Créer les îles
                MEDITERRANEAN_ISLANDS.forEach(island => {
                    const marker = document.createElement('div');
                    marker.className = `island-marker ${island.type}`;
                    marker.style.left = island.x + '%';
                    marker.style.top = island.y + '%';
                    marker.title = `${island.name} - ${island.specialty} (${island.bonus})`;
                    marker.textContent = island.name.charAt(0);
                    
                    marker.addEventListener('click', function() {
                        updateIslandInfo(island);
                    });
                    
                    worldMap.appendChild(marker);
                });

                // Ajouter quelques routes commerciales
                const routes = [
                    { from: { x: 25, y: 45 }, to: { x: 35, y: 55 } }, // Roma -> Sicilia
                    { from: { x: 35, y: 55 }, to: { x: 45, y: 40 } }, // Sicilia -> Creta
                    { from: { x: 20, y: 35 }, to: { x: 25, y: 45 } }  // Corsica -> Roma
                ];

                routes.forEach(route => {
                    const routeElement = document.createElement('div');
                    routeElement.className = 'trade-route';
                    
                    const dx = route.to.x - route.from.x;
                    const dy = route.to.y - route.from.y;
                    const length = Math.sqrt(dx * dx + dy * dy);
                    const angle = Math.atan2(dy, dx) * 180 / Math.PI;
                    
                    routeElement.style.left = route.from.x + '%';
                    routeElement.style.top = route.from.y + '%';
                    routeElement.style.width = length + '%';
                    routeElement.style.transform = `rotate(${angle}deg)`;
                    routeElement.style.transformOrigin = '0 50%';
                    
                    worldMap.appendChild(routeElement);
                });
            }

            // Gestionnaires d'événements pour les contrôles
            document.getElementById('zoom-in')?.addEventListener('click', () => {
                // Logique de zoom avant
                console.log('Zoom avant');
            });

            document.getElementById('zoom-out')?.addEventListener('click', () => {
                // Logique de zoom arrière
                console.log('Zoom arrière');
            });

            document.getElementById('center-map')?.addEventListener('click', () => {
                // Centrer sur Roma
                console.log('Centrer sur mes territoires');
            });

            document.getElementById('toggle-routes')?.addEventListener('click', () => {
                // Basculer l'affichage des routes
                const routes = document.querySelectorAll('.trade-route');
                routes.forEach(route => {
                    route.style.display = route.style.display === 'none' ? 'block' : 'none';
                });
            });
        });

        function updateIslandInfo(island) {
            const islandCard = document.querySelector('#island-info .island-card');
            if (islandCard) {
                islandCard.querySelector('.island-name').textContent = island.name;
                islandCard.querySelector('.island-type').textContent = `🏝️ Spécialité: ${island.specialty} (${island.bonus})`;
                
                // Mettre à jour le statut selon le type
                const statusElement = islandCard.querySelector('.island-status');
                switch(island.type) {
                    case 'my-territory':
                        statusElement.textContent = '👑 Sous mon contrôle';
                        break;
                    case 'ally':
                        statusElement.textContent = '🤝 Territoire allié';
                        break;
                    case 'enemy':
                        statusElement.textContent = '⚔️ Territoire ennemi';
                        break;
                    case 'neutral':
                        statusElement.textContent = '🏳️ Territoire neutre';
                        break;
                }

                // Mettre à jour les actions disponibles
                const actionsContainer = islandCard.querySelector('.island-actions');
                actionsContainer.innerHTML = '';
                
                if (island.type === 'neutral') {
                    actionsContainer.innerHTML = `
                        <button class="action-btn">🚢 Coloniser</button>
                        <button class="action-btn">👁️ Espionner</button>
                    `;
                } else if (island.type === 'enemy') {
                    actionsContainer.innerHTML = `
                        <button class="action-btn">⚔️ Attaquer</button>
                        <button class="action-btn">👁️ Espionner</button>
                    `;
                } else if (island.type === 'ally') {
                    actionsContainer.innerHTML = `
                        <button class="action-btn">⚖️ Commerce</button>
                        <button class="action-btn">🤝 Diplomatie</button>
                    `;
                } else {
                    actionsContainer.innerHTML = `
                        <button class="action-btn">🏛️ Gérer</button>
                        <button class="action-btn">🚢 Nouvelle Flotte</button>
                    `;
                }
            }
        }
    </script>
</body>
</html>